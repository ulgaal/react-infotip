<!DOCTYPE html><html lang="en"><head><title>src/utils</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="src/utils"><meta name="groc-project-path" content="src/utils.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/utils.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>Copyright 2019 Ulrich Gaal</p>
<p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<pre><code>http://www.apache.org/licenses/LICENSE-2.0</code></pre>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
<h1 id="utilsjs">utils.js</h1></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">import</span> deepmerge <span class="hljs-keyword">from</span> <span class="hljs-string">'deepmerge'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Returns the corner position of a rect</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> corner = (dimensions, position) =&gt; {
  <span class="hljs-keyword">const</span> { width = <span class="hljs-number">0</span>, height = <span class="hljs-number">0</span> } = dimensions
  <span class="hljs-keyword">switch</span> (position) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'top-left'</span>:
      <span class="hljs-keyword">return</span> {
        left: <span class="hljs-number">0</span>,
        top: <span class="hljs-number">0</span>
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'top-center'</span>:
      <span class="hljs-keyword">return</span> {
        left: width * <span class="hljs-number">0.5</span>,
        top: <span class="hljs-number">0</span>
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'top-right'</span>:
      <span class="hljs-keyword">return</span> {
        left: width,
        top: <span class="hljs-number">0</span>
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'center-left'</span>:
      <span class="hljs-keyword">return</span> {
        left: <span class="hljs-number">0</span>,
        top: height * <span class="hljs-number">0.5</span>
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'center-right'</span>:
      <span class="hljs-keyword">return</span> {
        left: width,
        top: height * <span class="hljs-number">0.5</span>
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'bottom-left'</span>:
      <span class="hljs-keyword">return</span> {
        left: <span class="hljs-number">0</span>,
        top: height
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'bottom-center'</span>:
      <span class="hljs-keyword">return</span> {
        left: width * <span class="hljs-number">0.5</span>,
        top: height
      }
    <span class="hljs-keyword">case</span> <span class="hljs-string">'bottom-right'</span>:
      <span class="hljs-keyword">return</span> {
        left: width,
        top: height
      }
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Unknown position <span class="hljs-subst">${position}</span>`</span>, position)
  }
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Compute the overlap of two rects</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> overlap = (r1, r2) =&gt; ({
  width: <span class="hljs-built_in">Math</span>.max(
    <span class="hljs-number">0</span>,
    <span class="hljs-built_in">Math</span>.min(r1.left + r1.width, r2.left + r2.width) -
      <span class="hljs-built_in">Math</span>.max(r1.left, r2.left)
  ),
  height: <span class="hljs-built_in">Math</span>.max(
    <span class="hljs-number">0</span>,
    <span class="hljs-built_in">Math</span>.min(r1.top + r1.height, r2.top + r2.height) - <span class="hljs-built_in">Math</span>.max(r1.top, r2.top)
  )
})</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Compute the surface of a rect</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> surface = ({ width, height }) =&gt; width * height</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Read a property from an object</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getProperty = (obj, path) =&gt;
  path
    .split(<span class="hljs-string">'.'</span>)
    .reduce(
      (obj, prop) =&gt;
        obj &amp;&amp; <span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(obj, prop)
          ? obj[prop]
          : <span class="hljs-literal">null</span>,
      obj
    )</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Appends the <code>px</code> suffix to the values of an object</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> pixelize = obj =&gt;
  <span class="hljs-built_in">Object</span>.entries(obj || {}).reduce((obj, [key, value]) =&gt; {
    obj[key] = <span class="hljs-string">`<span class="hljs-subst">${value}</span>px`</span>
    <span class="hljs-keyword">return</span> obj
  }, {})</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Merge two objects</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mergeObjects = (obj1, obj2) =&gt; {
  <span class="hljs-keyword">if</span> (obj1) {
    <span class="hljs-keyword">if</span> (obj2) {
      <span class="hljs-keyword">return</span> deepmerge(obj1, obj2)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> obj1
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (obj2) {
      <span class="hljs-keyword">return</span> obj2
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> {}
    }
  }
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Compute the bounding rect of a DOMElement</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> toRect = element =&gt; {
  <span class="hljs-keyword">const</span> rect = element
    ? element.getBoundingClientRect()
    : { left: <span class="hljs-number">0</span>, top: <span class="hljs-number">0</span>, width: <span class="hljs-number">0</span>, height: <span class="hljs-number">0</span> }
  <span class="hljs-keyword">const</span> { left, top, width, height } = rect
  <span class="hljs-keyword">return</span> {
    left: left + <span class="hljs-built_in">window</span>.scrollX,
    top: top + <span class="hljs-built_in">window</span>.scrollY,
    width,
    height
  }
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Returns the DOMElement specified by the value (or the document <code>&lt;body&gt;</code> if no value is specified)</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getElement = value =&gt; {
  <span class="hljs-keyword">if</span> (!value) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.body
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.querySelector(value)
  }
  <span class="hljs-keyword">return</span> value
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Returns true if two Sets are equal</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> eqSet = (<span class="hljs-keyword">as</span>, bs) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">as</span>.size !== bs.size) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a <span class="hljs-keyword">of</span> <span class="hljs-keyword">as</span>) {
    <span class="hljs-keyword">if</span> (!bs.has(a)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Substracts two Sets.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> diffSet = (<span class="hljs-keyword">as</span>, bs) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...as].filter(obj =&gt; !bs.has(obj)))</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>A sequence generator function</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> * <span class="hljs-title">seq</span> (<span class="hljs-params">start, end</span>) </span>{
  <span class="hljs-keyword">if</span> (start &lt; end) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> current = start; current &lt; end; current++) {
      <span class="hljs-keyword">yield</span> current
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> current = start; current &gt; end; current--) {
      <span class="hljs-keyword">yield</span> current
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> LOGS = {
  source: <span class="hljs-number">0</span>,
  storage: <span class="hljs-number">0</span>
}</div></div></div></div></body></html>